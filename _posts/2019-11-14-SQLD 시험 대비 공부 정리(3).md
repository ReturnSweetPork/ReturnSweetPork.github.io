# SQLD 시험 대비 공부 정리(3)

## Chapter2. 데이터 모델과 성능

## 1. 성능데이터 모델링의 정의

### 성능데이터 모델링이란?

- 데이터 베이스 성능향상을 목적으로 설계 단계의 데이터 모델링 때부터 정규화, 반정규화, 테이블 통합, 조인구조, PK, FK등 성능과 관련된 사항이 데이터 모델링에 반영될 수 있도록 하는것

### 수행시점

- 프로젝트 수행중 사전에 할수록 비용이 들지 않는다
- 특히 '분석,설계' 단계에서 수행할 경우 비용 최소화가 가능하다

### 성능데이터 모델링 고려사항

- 모델링 할때 정규화를 정확하게 수행
- 데이터베이스 용량산정을 실시한다
- 데이터베이스에 발생되는 트랜젝션의 유형을 파악한다
- 용량과 트랜젝션의 유형에 따라서 반정규화 실시
- 이력 모델 조정, PK, FK조정, 슈퍼/서브 타입 조정
- 성능관점에서 데이터 모델을 검증함

## 2. 정규화와 성능

### 정규화를 통한 성능향상 전략

- 정규화 - 데이터 중복성을 제거하여 성능을 올린다
- 정규화의 수행시 입력/수정/삭제 성능은 향상된다
- 정규화의 수행시 조회성능은 향상되거나 또는 저하된다.

## 3. 반정규화와 성능

### 반정규화의 정의

- 정규화된 엔터티,속성,관계에 대해 시스템의 성능향상과 개발과 운영의 단순화를 위해 중복,통합,분리등을 수행하는 데이터 모델링의 기법

### 반정규화를 하는 이유?

- 데이터를 조회할때 디스크 I/O양이 많아서 성능이 저하 되거나 경로가 너무 멀어 조인으로 인한 성능저하가 예상되거나 칼럼을 계산하여 읽을때 성능이 저하될것이 예상되는 경우

### 반정규화의 적용방법

- 데이터 무결성이 중요함을 알고 데이터 무결성이 충분히 유지 될수 있도록 프로세스 처리에 있어서 안정성이 먼저 확인되어야 한다.

#### 1. 반정규화 대상 조사 

- 테이블에 접근하는 프로세스의 수가 많고 일정한 범위일 경우
- 대량의 데이터를 줄이지 않으면 성능저하가 일어나는 경우
- 통계테이블이 필요시
- 조인이 많이 걸려 있을경우

#### 2. 다른방법 유도 검토

- 뷰테이블
- 클러스터링
- 인덱스의 조정
- 응용어플리케이션

#### 3. 반정규화 적용

### 반정규화의 기법

#### 1. 테이블 반정규화

- 테이블 병합 - 1:1/1:M/슈퍼/서브타입
- 테이블분할 - 수직(컬럼단위)/수평(로우단위)
- 테이블추가 - 중복,통계,이력,부분 테이블 추가

#### 2. 칼럼반정규화

- 중복칼럼추가 - 조인성능은 저하하지 않는다
- 파생칼럼추가 - 미리 값을 계산하여 칼럼에 보관
- 이력테이블 칼럼추가 - 기능성칼럼추가
- PK에 의한 칼럼추가 - PK안에 데이터가 존재하지만 성능향상을 위해 일반 속성으로 포함하는 방법
- 응용시스템 오작동을 위한 칼럼추가 - 데이터를 임시로 보관하는 칼럼추가

#### 3. 관계 반정규화 중복관계추가

- 중복관계 추가 - 추가적인 관계를 맺는 방법

*테이블 칼럼 반정규화는 데이터의 무결성을 깨뜨리지만 관계 반정규화는 깨뜨리지 않는다.

## 4. 대량데이터에 따른 성능

### 대량데이터 발생에 따른 테이블 분할 개요

- 트랜젝션 분산처리르 위한 테이블 단위에서 분할의 방법을 적용
- 한테이블에 많은 수의 칼럼을 가지고 있는경우에 디스크 I/O양이 증가하여 성능이 저하된다
- 테이블 쪼개어 주면 디스크 I/O가 감소하게 되어 성능이 개선된다.

### 대량 데이터 저장 및 처리로 안한 성능향상

- Range Partition
- List Partition
- Hash Partition
- composite Partition

### 테이블에 대한 수평/수직 분할 절차

1. 데이터 모델링을 완성한다
2. 데이터 베이스 용량을 산정함
3. 대량 데이터가 처리되는 테이블에 대해서 트랜젝션 처리 패턴을 분석한다
4. 칼럼 단위/로우 단위로 분석하여 테이블을 분리한다.

## 5. 데이터베이스 구조와 성능

### 1. 슈퍼타입/서브타입 모델

- 업무를 구성하는 데이터의 특징을 공통과 차이점의 특징을 고려하여 효과적으로 표현 가능하다
- 공통부분을 수퍼타입 , 차이가 있는 부분을 서브타입으로 한다
- 물리적 데이터 베이스 모델로 변환할때 선택의 폭을 넓힐수 있다.
- 모델 변환 방법은 one to one type/plus type/ single type(all in one)
- 변환 기준은 데이터의 양과 트랜잭션의 유형이다.
- 슈퍼/서브 타입 데이터 모델의 변환기술
  - 개별로 발생되는 트랜잭션에 대해서 개별로 테이블을 구성한다( one to one type)
  - 슈퍼타입 + 서브타입에 대해 발생하는 트랙잭션어 데해서 슈퍼타입+서브타입 테이블로 구성함(plus type)
  - 전체를 하나로 묶어 테이블 구성(all in one)



### 2. 인덱스 특성을 고려한 PK/FK 데이터 베이스 성능 향상

### 3. 물리적인 테이블에 FK제약이 걸려있지 않을 경우 인덱스 미생성으로 성능 저하됨

## 6. 분산데이터 베이스와 성능

- 여러곳으로 분산되어 있는 데이터 베이스를 1개의 가상 시스템으로 사용 가능
- 논리적으로 동일 하나 물리적으로 분산되어 있음

### 분산 데이터 베이스의 투명성

- 분할 투명성
- 위치투명성
- 지역사상 투명성
- 중복 투명성
- 장애 투명성
- 병행투명성

### 분산데이터 베이스 적용방법

- 업무의 흐름을 보고 업무 구성에 따른 아키텍쳐 특징에 따라서 데이터 베이스를 구성한다

### 분산데이터 베이스의 장단점

- 장점
  - 신뢰성
  - 빠른 속도
  - 효용성
- 단점
  - 비싸다
  - 복잡하다
  - 어렵다
  - 무결성을 해칠 위험이 있다

### 분산데이터 베이스 적용 기법

- 테이블 위치 분산
  - 구조변화는 없다
  - 설계된 테이블 위치를 다르게함
- 테이블 분할 분산
  - 테이블을 쪼개어 분산함
  - 로우단위/컬럼단위
- 테이블 복제 분산(가장 많이 쓴다)
  - 부분복제
  - 광역복제
- 테이블 요약 분산
  - 분석요약
  - 통합요약